{% extends "sabuzz/base.html" %}

{% block title %}Home - SA Buzz{% endblock %}

{% block content %}

<!-- HERO -->
<div class="bg-black text-white rounded-xl p-10 shadow-lg mb-10">
    <h1 class="text-4xl font-bold mb-2">SA Buzz</h1>
    <p class="text-lg">Your intelligent gateway to real-time South African news.</p>
</div>

<!-- SEARCH BAR -->
<div class="flex mb-8">
    <form class="flex w-full" method="GET" action="{% url 'search' %}">
        <input type="text" name="q"
               placeholder="Search news headlines..."
               class="w-full p-3 rounded-l-lg bg-white text-black shadow">
        <button class="bg-yellow-400 text-black px-6 rounded-r-lg font-semibold">
            Search
        </button>
    </form>
</div>

<!-- TRENDING BAR -->
{% if articles %}
<div class="bg-yellow-400 text-black p-4 rounded-lg mb-10 flex items-center space-x-3">
    <span class="text-xl">üî•</span>
    <span class="font-semibold">Trending:</span>
    <span>{{ articles.0.title|default:"" }}</span>
</div>
{% endif %}

<!-- SECTION TITLE -->
<h2 class="text-2xl font-bold mb-4">Latest South African News</h2>

<!-- API NEWS ARTICLES -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

    {% for article in articles %}
    <div class="bg-white text-black rounded-xl shadow-md p-4">

        {% if article.image_url %}
        <img src="{{ article.image_url }}" class="w-full h-48 object-cover rounded-md mb-3">
        {% else %}
        <div class="w-full h-48 bg-gray-200 flex items-center justify-center rounded-md mb-3">
            No Image Available
        </div>
        {% endif %}

        <h3 class="text-xl font-semibold mb-2">{{ article.title }}</h3>

        <p class="text-gray-700 mb-3">{{ article.description|truncatewords:20 }}</p>

        <a href="{{ article.link }}" target="_blank"
           class="inline-block bg-[#0b1525] text-white px-4 py-2 rounded-lg mb-3">
           Read More ‚Üí
        </a>

        <form method="POST" action="{% url 'save_article' %}">
            {% csrf_token %}
            <input type="hidden" name="title" value="{{ article.title }}">
            <input type="hidden" name="description" value="{{ article.description }}">
            <input type="hidden" name="url" value="{{ article.link }}">
            <input type="hidden" name="image_url" value="{{ article.image_url }}">
            <input type="hidden" name="source_name" value="{{ article.source_id }}">

            <button class="bg-yellow-400 text-black w-full py-2 rounded-lg mt-2 font-semibold">
                ‚≠ê Save Article
            </button>
        </form>
    </div>
    {% endfor %}
</div>

<!-- LOCAL POSTS SECTION -->
<h2 class="text-2xl font-bold mt-12 mb-4">Latest Journalist Posts</h2>

{% if local_posts %}
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

    {% for post in local_posts %}
    <div class="bg-white text-black rounded-xl shadow-md p-4">

        {% if post.image %}
        <img src="{{ post.image.url }}" class="w-full h-48 object-cover rounded-md mb-3">
        {% else %}
        <div class="w-full h-48 bg-gray-200 flex items-center justify-center rounded-md mb-3">
            No Image
        </div>
        {% endif %}

        <h3 class="text-xl font-semibold mb-2">{{ post.title }}</h3>

        <p class="text-gray-700 mb-3">{{ post.content|truncatewords:20 }}</p>

        <a href="{% url 'post_detail' post.id %}"
           class="inline-block bg-yellow-400 text-black px-4 py-2 rounded-lg mb-3">
           Read More ‚Üí
        </a>

    </div>
    {% endfor %}

</div>
{% else %}
<p class="text-gray-500">No approved posts yet.</p>
{% endif %}

{% endblock %}
